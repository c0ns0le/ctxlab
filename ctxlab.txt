# Boxstarter options
$Boxstarter.RebootOk=$true # Allow reboots?
$Boxstarter.NoPassword=$false # Is this a machine with no login password?
$Boxstarter.AutoLogin=$true # Save my password securely and auto-login after a reboot

# Basic Setup
Update-ExecutionPolicy Unrestricted
Set-ExplorerOptions -showProtectedOSFiles -showFileExtensions
Set-StartScreenOptions -EnableBootToDesktop
Enable-RemoteDesktop
Disable-InternetExplorerESC
Disable-UAC

if (Test-PendingReboot) { Invoke-Reboot }

# Rename Computer
Rename-Computer -NewName DC-01
if (Test-PendingReboot) { Invoke-Reboot }

# Add Roles and Feature for Active Directory

Add-WindowsFeature "RSAT-AD-Tools"
Add-WindowsFeature -Name "ad-domain-services" -IncludeAllSubFeature -IncludeManagementTools
Add-WindowsFeature -Name "dns" -IncludeAllSubFeature -IncludeManagementTools
Add-WindowsFeature -Name "gpmc" -IncludeAllSubFeature -IncludeManagementTools
Add-WindowsFeature -Name "rds-licensing"
Add-WindowsFeature -Name "rds-licensing-ui"

Install-ADDSForest `
-CreateDnsDelegation:$false `
-DatabasePath "C:\Windows\NTDS" `
-DomainMode "Win2012R2" `
-DomainName â€œctxlab.local" `
-DomainNetbiosName "ctxlab" `
-ForestMode "Win2012R2" `
-InstallDns:$true `
-LogPath "C:\Windows\NTDS" `
-NoRebootOnCompletion:$true `
-SysvolPath "C:\Windows\SYSVOL"
-Force:$true

if (Test-PendingReboot) { Invoke-Reboot }


cinst notepadplusplus
cinst sysinternals