# Boxstarter options
$Boxstarter.RebootOk=$true # Allow reboots?
$Boxstarter.NoPassword=$false # Is this a machine with no login password?
$Boxstarter.AutoLogin=$true # Save my password securely and auto-login after a reboot

# Basic Setup
Update-ExecutionPolicy Unrestricted
Set-StartScreenOptions -EnableBootToDesktop
Enable-RemoteDesktop
Disable-UAC

#Install Chocolatey Applications
cinst win-no-annoy
cinst notepadplusplus
cinst sysinternals

# File association
Install-ChocolateyFileAssociation ".txt" "$env:programfiles(x86)\Notepad++\notepad++.exe"

# Taskbar items
Install-ChocolateyPinnedTaskBarItem "$env:windir\explorer.exe"
Install-ChocolateyPinnedTaskBarItem "$env:SystemRoot\system32\WindowsPowerShell\v1.0\powershell.exe"
Install-ChocolateyPinnedTaskBarItem "$env:SystemRoot\system32\cmd.exe"
Install-ChocolateyPinnedTaskBarItem "$env:programfiles(x86)\Notepad++\notepad++.exe"

# Add Roles and Feature for Active Directory
Add-WindowsFeature "RSAT-AD-Tools"
Add-WindowsFeature -Name "ad-domain-services" -IncludeAllSubFeature -IncludeManagementTools
Add-WindowsFeature -Name "dns" -IncludeAllSubFeature -IncludeManagementTools
Add-WindowsFeature -Name "gpmc" -IncludeAllSubFeature -IncludeManagementTools
Add-WindowsFeature -Name "rds-licensing"
Add-WindowsFeature -Name "rds-licensing-ui"

Install-ADDSForest `
-CreateDnsDelegation:$false `
-DatabasePath "C:\Windows\NTDS" `
-DomainMode "Win2012R2" `
-DomainName "ctxlab.local" `
-DomainNetbiosName "ctxlab" `
-ForestMode "Win2012R2" `
-InstallDns:$true `
-LogPath "C:\Windows\NTDS" `
-NoRebootOnCompletion:$true `
-SysvolPath "C:\Windows\SYSVOL" `
-Force:$true

# Rename Computer
Rename-Computer -NewName DC-01
Invoke-Reboot


